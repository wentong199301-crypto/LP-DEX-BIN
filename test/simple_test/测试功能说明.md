# test/simple_test 文件夹测试功能说明

## 测试文件功能概述

### 1. market_test.py
**功能**: 市场池和价格查询测试（只读操作，不涉及交易）
- 查询 Solana 链上的 Raydium CLMM 池信息
- 查询 Solana 链上的 Meteora DLMM 池信息
- 查询 Ethereum 链上的 Uniswap V3 池信息
- 查询 BSC 链上的 PancakeSwap V3 池信息
- 显示每个池的地址、符号、价格、TVL、代币信息、费率等

### 2. raydium_test.py ⭐
**功能**: Raydium CLMM 流动性提供（开仓和撤仓）测试
- **开仓**: 在 SOL/USDC 池中开仓，使用 $2 USD，价格范围 ±1%
- **撤仓**: 关闭所有 Raydium 持仓
- **费用记录**: 记录开仓和撤仓的交易费用（以 lamports 和 SOL 为单位）
- **余额跟踪**: 记录开仓前后的 SOL 和 USDC 余额变化

### 3. meteora_test.py ⭐
**功能**: Meteora DLMM 流动性提供（开仓和撤仓）测试
- **开仓**: 在 SOL/USDC 池中开仓，使用 $2 USD，价格范围 ±1%
- **撤仓**: 关闭所有 Meteora 持仓
- **费用记录**: 记录开仓和撤仓的交易费用（以 lamports 和 SOL 为单位）
- **余额跟踪**: 记录开仓前后的 SOL 和 USDC 余额变化

### 4. uniswap_test.py ⭐
**功能**: Uniswap V3 流动性提供（开仓和撤仓）测试
- **开仓**: 在 WETH/USDC 池中开仓，价格范围 ±1%
- **撤仓**: 关闭所有 Uniswap 持仓
- **费用记录**: 记录交易 gas 费用（以 ETH 为单位）
- **余额跟踪**: 记录开仓前后的 ETH 和 USDC 余额变化
- **链**: Ethereum (Chain ID 1)

### 5. pancakeswap_test.py ⭐
**功能**: PancakeSwap V3 流动性提供（开仓和撤仓）测试
- **开仓**: 在 WBNB/USDT 池中开仓，价格范围 ±1%
- **撤仓**: 关闭所有 PancakeSwap 持仓
- **费用记录**: 记录交易 gas 费用（以 BNB 为单位）
- **余额跟踪**: 记录开仓前后的 BNB 和 USDT 余额变化
- **链**: BSC (Chain ID 56)

### 6. swap_test.py
**功能**: 跨链交换测试（往返交换）
- Solana: SOL -> USDC -> SOL (通过 Jupiter)
- Ethereum: USDC -> ETH -> USDC (通过 1inch)
- BSC: BNB -> USDT -> BNB (通过 1inch)
- **注意**: 这些测试会执行真实的交换操作并消耗真实的代币

### 7. wallet_test.py
**功能**: 钱包余额查询测试（只读操作）
- 查询 Solana 链上的 SOL 和 USD1 余额
- 查询 BSC 链上的 USDT 余额
- 查询 Ethereum 链上的 ETH 和 USDC 余额

## 开仓和撤仓测试文件（⭐标记）

以下文件实现了完整的开仓和撤仓测试，并会记录费用：

1. **raydium_test.py** - Solana 链，Raydium CLMM
2. **meteora_test.py** - Solana 链，Meteora DLMM
3. **uniswap_test.py** - Ethereum 链，Uniswap V3
4. **pancakeswap_test.py** - BSC 链，PancakeSwap V3

## 运行测试所需的环境变量

### Solana 链测试（Raydium, Meteora）
- `SOLANA_RPC_URL`: Solana RPC 端点 URL
- `SOLANA_PRIVATE_KEY`: Base58 编码的私钥（或 `SOLANA_KEYPAIR_PATH`）

### EVM 链测试（Uniswap, PancakeSwap）
- `EVM_PRIVATE_KEY`: EVM 私钥
- `ETH_RPC_URL`: Ethereum RPC URL（可选）
- `BSC_RPC_URL`: BSC RPC URL（可选）
- `ONEINCH_API_KEY`: 1inch API 密钥（用于交换功能）

## 费用记录格式

每个开仓/撤仓测试都会输出以下费用信息：

### Solana 链（Raydium, Meteora）
```
COST SUMMARY
  Open fee:       [lamports] ([SOL])
  Close fee:      [lamports] ([SOL])
  TOTAL FEES:     [lamports] ([SOL])
  WALLET BALANCE CHANGES:
    SOL:  [+/-变化]
    USDC: [+/-变化]
  NET SOL COST (fees only): [SOL]
```

### EVM 链（Uniswap, PancakeSwap）
```
COST SUMMARY
  WALLET BALANCE CHANGES:
    ETH/BNB:  [+/-变化]
    USDC/USDT: [+/-变化]
  NET [TOKEN] COST (gas only): [amount]
```


